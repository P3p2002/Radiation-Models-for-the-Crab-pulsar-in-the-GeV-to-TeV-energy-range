# -*- coding: utf-8 -*-
"""
Created on Mon Mar 25 17:06:58 2024

@author: Pep Rubi
Here are the values of the f function along with the phase.
There are quiet a few energy intervals:
    1: 0.4 - 0.6 keV
    2: 0.6 - 2.0 keV
    3. 2.0 - 4.0 keV
    4: 4.0 - 10 keV
    5: 10 - 14 keV
    6: 14 - 40 keV
    7: 40 - 90 keV
    8: 90 -250 keV
"""

import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
import astropy.units as u

T     = 33*10**(-3)*u.s # per√≠ode de Crab (s)

#The first number indicates the interval and the second one which peak

phase_1_2 = [0.19615384615384626, 0.2153846153846154, 0.2384615384615385, 0.2576923076923078, 0.27564098651592556, 0.2948717557466948, 0.3128204345703125, 0.33076923076923076, 0.3423076923076924, 0.35512812687800477, 0.3705127422626201, 0.37948714036207926, 0.3897435114933895, 0.40769230769230774, 0.4128204345703125, 0.4166665884164663, 0.423076923076923, 0.43076923076923074, 0.4397435114933894, 0.45384615384615384, 0.46923076923076923, 0.4884615384615382, 0.5051281268780048, 0.5217948326697714, 0.5423076923076922, 0.5666665884164662, 0.5897435114933893, 0.6153846153846152, 0.6397435114933894, 0.6679486788236175]
f_1_2 = [0.28806817550316777, 0.35391077980497765, 0.4197533841067873, 0.5843644159831451, 0.650207020284955, 0.8477378472716066, 1.1769568969431, 1.539095741724887, 1.9341573956981903, 2.395061653973303, 2.8559689263296386, 3.382715788906561, 3.942388474756222, 3.843623061262896, 3.3497959937962674, 2.8559689263296386, 2.4609072723563354, 2, 1.4732531374230773, 1.0781914834497741, 0.7160496245867647, 0.5514416067916292, 0.35391077980497765, 0.28806817550316777, 0.22222255712013572, 0.09053734851651618, 0.09053734851651618, 0.05761453932500027, 0.05761453932500027, 0.05761453932500027]

phase_2_2 = [0.1935896653395434, 0.2166665884164665, 0.23589735764723563, 0.25897428072415873, 0.27820504995492795, 0.29871790959284855, 0.3153846153846154, 0.3294871403620793, 0.3448717557466947, 0.3576923076923076, 0.36923076923076925, 0.37948714036207926, 0.3910256019005409, 0.40769230769230774, 0.4128204345703125, 0.41794867882361775, 0.424358896108774, 0.43461538461538457, 0.4474358191856971, 0.46025637113131007, 0.4769230769230769, 0.49358966533954307, 0.51025637113131, 0.5282050499549278, 0.5525640634390022, 0.5769230769230768, 0.6038461538461537, 0.6269230769230768, 0.6499999999999999, 0.6782050499549276]
f_2_2 = [0.3209879706134615, 0.4197533841067873, 0.45267619329830344, 0.650207020284955, 0.8477378472716066, 1.1440340877515838, 1.3744877239297515, 1.7695493779030547, 2.1316882226848417, 2.625515290151471, 3.1851849619199095, 3.5802466158932127, 4.106996492551358, 3.843623061262896, 3.2839503754132355, 2.7242807036447965, 2.1316882226848417, 1.637861155218213, 1.1440340877515838, 0.7818952429697967, 0.5185187976001131, 0.4197533841067873, 0.28806817550316777, 0.12345714362680993, 0.12345714362680993, 0.09053734851651618, 0.09053734851651618, 0.09053734851651618, -0.008228064976809613, -0.008228064976809613]
    
phase_3_2 = [0.18974351149338944, 0.20641021728515627, 0.22692307692307706, 0.2461538461538462, 0.2666665884164664, 0.28846153846153855, 0.3089742807241588, 0.3282050499549279, 0.3423076923076924, 0.35512812687800477, 0.36410252497746387, 0.3705127422626201, 0.37948714036207926, 0.387179448054387, 0.4038461538461538, 0.40897428072415865, 0.4128204345703125, 0.42051274226262014, 0.42820504995492786, 0.4358973576472356, 0.4525640634390024, 0.4717948326697714, 0.4910256019005409, 0.5115384615384613, 0.5320512038010816, 0.5589742807241584, 0.583333294208233, 0.6064102172851562, 0.633333294208233, 0.6589742807241583, 0.6833332942082329]
f_3_2 = [0.4197533841067873, 0.45267619329830344, 0.5843644159831451, 0.650207020284955, 0.8148150380800905, 1.0452686742582582, 1.3744877239297515, 1.8024691730133484, 2.2304536361781677, 2.526749876658145, 2.954734339822964, 3.3497959937962674, 3.8107002520713804, 4.2386847152362, 4.139919301742873, 3.613169425084729, 3.0534997533162898, 2.493827067466629, 1.9341573956981903, 1.4074075190400452, 0.9465032607649324, 0.5843644159831451, 0.28806817550316777, 0.12345714362680993, 0.09053734851651618, 0.05761453932500027, 0.05761453932500027, 0.05761453932500027, 0.05761453932500027, 0.024691730133484135, -0.041150874168325746]

phase_4_2 = [0.19230769230769232, 0.21025637113131024, 0.2320512038010819, 0.2538461538461539, 0.2743588961087741, 0.2961538461538462, 0.3153846153846154, 0.3320512038010819, 0.347435819185697, 0.3576923076923076, 0.3679486788236178, 0.3769230769230769, 0.3884615384615384, 0.40512812687800476, 0.4102563711313101, 0.4141025249774639, 0.4217948326697716, 0.42820504995492786, 0.437179448054387, 0.44999999999999996, 0.4653846153846152, 0.4884615384615382, 0.5076923076923077, 0.5320512038010816, 0.5551281268780046, 0.5794871403620792, 0.6025640634390023, 0.6243588961087739, 0.6461538461538459, 0.666666588416466]
f_4_2 = [0.5514416067916292, 0.5843644159831451, 0.650207020284955, 0.7818952429697967, 1.0452686742582582, 1.2757223104364257, 1.6049383460266968, 2.032922809191516, 2.4279844631648193, 2.921811530631448, 3.2181077711114257, 3.7119348385780544, 4.2386847152362, 4.041153888249548, 3.5144040115914033, 2.8888887214399324, 2.3621418588630094, 1.8353919822048645, 1.3415649147382354, 0.9465032607649324, 0.5843644159831451, 0.35391077980497765, 0.22222255712013572, 0.15637995281832606, 0.09053734851651618, 0.09053734851651618, 0.09053734851651618, 0.024691730133484135, 0.024691730133484135, -0.008228064976809613]

phase_5_2 = [0.1935896653395434, 0.21410252497746396, 0.23717944805438707, 0.26025637113131017, 0.28205120380108184, 0.3025640634390025, 0.3192307692307693, 0.33717944805438704, 0.351281973031851, 0.3615384615384616, 0.3756409865159255, 0.38589735764723554, 0.39743581918569704, 0.4064102172851562, 0.4115384615384615, 0.41538461538461535, 0.424358896108774, 0.4320512038010817, 0.44102560190054085, 0.4576923076923077, 0.4769230769230769, 0.49871790959284856, 0.5141025249774638, 0.5384615384615383, 0.5628204345703123, 0.583333294208233, 0.6076923076923075, 0.633333294208233, 0.6589742807241583, 0.6897435114933892]
f_5_2 = [0.650207020284955, 0.7489724337782808, 0.8477378472716066, 1.0452686742582582, 1.2427995012449098, 1.572018550916403, 1.8353919822048645, 2.2304536361781677, 2.6913578944532803, 3.1193423576181, 3.646092234276245, 4.172839096853167, 4.469135337333145, 3.8107002520713804, 3.1851849619199095, 2.559672685849661, 1.9670802048897063, 1.506172932533371, 1.0452686742582582, 0.650207020284955, 0.4197533841067873, 0.22222255712013572, 0.15637995281832606, 0.15637995281832606, 0.12345714362680993, 0.05761453932500027, 0.024691730133484135, 0.024691730133484135, -0.008228064976809613, 0.024691730133484135]

phase_6_2 = [0.2, 0.22051274226262024, 0.24230769230769245, 0.26282043457031257, 0.2871794480543871, 0.30641021728515627, 0.3217948326697716, 0.33717944805438704, 0.35384615384615387, 0.3653846153846153, 0.373076923076923, 0.38589735764723554, 0.39743581918569704, 0.40897428072415865, 0.4102563711313101, 0.4166665884164663, 0.423076923076923, 0.43333329420823313, 0.44358966533954325, 0.45897428072415863, 0.48076923076923056, 0.5025640634390023, 0.5243588961087738, 0.5499999999999998, 0.5743588961087739, 0.5987179095928484, 0.6243588961087739, 0.6551281268780047, 0.6807692307692307]
f_6_2 = [0.7818952429697967, 0.9135804515734163, 1.0452686742582582, 1.2098766920533937, 1.4732531374230773, 1.7366265687115385, 2, 2.4279844631648193, 2.7572035128363126, 3.2181077711114257, 3.646092234276245, 4.074073683359842, 4.502058146524661, 3.7119348385780544, 3.251030580302942, 2.6584380993429866, 2.0658456183830323, 1.4732531374230773, 0.9465032607649324, 0.5514416067916292, 0.35391077980497765, 0.22222255712013572, 0.15637995281832606, 0.15637995281832606, 0.12345714362680993, 0.09053734851651618, 0.024691730133484135, 0.05761453932500027, 0.05761453932500027]

phase_7_2 = [0.19487175574669482, 0.21410252497746396, 0.23589735764723563, 0.25897428072415873, 0.28205120380108184, 0.30128197303185106, 0.3153846153846154, 0.3333332942082333, 0.34615384615384615, 0.36025637113131015, 0.37179483266977154, 0.37948714036207926, 0.387179448054387, 0.39743581918569704, 0.40512812687800476, 0.4102563711313101, 0.41538461538461535, 0.4217948326697716, 0.42820504995492786, 0.43846153846153846, 0.45128197303185097, 0.46923076923076923, 0.4884615384615382, 0.5076923076923077, 0.5294871403620791, 0.5525640634390022, 0.5782050499549278, 0.6038461538461537, 0.6282050499549277, 0.6499999999999999]
f_7_2 = [0.8477378472716066, 1.012345865066742, 1.1111112785600679, 1.2427995012449098, 1.4732531374230773, 1.8353919822048645, 2.032922809191516, 2.3621418588630094, 2.6584380993429866, 3.0864195484265835, 3.5144040115914033, 3.975308269866516, 4.304527319538009, 4.534980955716177, 3.942388474756222, 3.3497959937962674, 2.7242807036447965, 2.1316882226848417, 1.539095741724887, 1.1111112785600679, 0.6831298294764709, 0.4197533841067873, 0.18930276200984197, 0.15637995281832606, 0.09053734851651618, 0.024691730133484135, -0.008228064976809613, 0.024691730133484135, -0.008228064976809613, 0.024691730133484135]

phase_8_2 = [0.19102560190054088, 0.21410252497746396, 0.23589735764723563, 0.2576923076923078, 0.2833332942082333, 0.30512812687800484, 0.32307692307692304, 0.3384615384615385, 0.35512812687800477, 0.3666665884164664, 0.3756409865159255, 0.38589735764723554, 0.3987179095928486, 0.4064102172851562, 0.40897428072415865, 0.4115384615384615, 0.4141025249774639, 0.4192307692307692, 0.424358896108774, 0.4358973576472356, 0.4474358191856971, 0.46923076923076923, 0.49358966533954307, 0.5141025249774638, 0.5384615384615383, 0.5653846153846152, 0.5910256019005407, 0.6153846153846152, 0.643589665339543, 0.6717948326697716]
f_8_2 = [0.9465032607649324, 1.1111112785600679, 1.1769568969431, 1.4074075190400452, 1.6707839644097289, 1.9341573956981903, 2.296296240479977, 2.5925924809599548, 3.020576944124774, 3.4814812023998867, 3.942388474756222, 4.370369923839819, 4.666666164319796, 4.172839096853167, 3.646092234276245, 3.2181077711114257, 2.5925924809599548, 2, 1.4403303282315614, 1.012345865066742, 0.6172842110934389, 0.28806817550316777, 0.09053734851651618, 0.05761453932500027, 0.024691730133484135, 0.09053734851651618, 0.05761453932500027, 0.024691730133484135, 0.024691730133484135, 0.024691730133484135]

phases = [phase_1_2, phase_2_2, phase_3_2, phase_4_2, phase_5_2, phase_6_2, phase_7_2, phase_8_2]
fs =  [f_1_2, f_2_2, f_3_2, f_4_2, f_5_2, f_6_2, f_7_2, f_8_2]


x = np.arange(0.2,0.5, 0.001)

#Funci√≥ Lorentziana
def lor(x, x0, sigma, A):
    
    den = (x-x0)**2 +(sigma/2)**2
    
    return A*sigma/(den*np.pi*2)

#Funci√≥ lorentziana asimetrica
def as_lorentz(x,x0,sigma1,sigma2, A):
    
    return np.where(x<=x0,A*sigma1/((sigma1**2+(x-x0)**2)*np.pi) , A*sigma2**2/((sigma2**2+(x-x0)**2)*np.pi*sigma1))

#Funci√≥ Lorentziana asimetrica amb la C sumant a l'esquerra
def asym_lorentz_C(x,x0,sigma1,sigma2, A, C):
    
    return np.where(x<=x0,A*sigma1/((sigma1**2+(x-x0)**2)*np.pi) + C,A*sigma2/((sigma2**2+(x-x0)**2)*np.pi)*sigma2*(1+sigma1*C*np.pi/A)/sigma1)

#Funci√≥ per ajustar les dades
def adjust_as_lor(phases, fs):
    x_initial = 0.4
    gamma_initial1 = 0.1
    gamma_initial2 = 0.1
    A_initial = 0.5
    C_initial = 3
    
    X0s = []
    sigmes1 = []
    sigmes2 = []
    As = []
    Cs = []
    cov = []
    for i in range(len(phases)):
    
        phases_arr = np.array(phases[i])
        ids = np.where((phases_arr>0.2) & (phases_arr<0.5))
        f_arr = np.array(fs[i])
        popt, pcov = curve_fit(asym_lorentz_C, phases_arr[ids], f_arr[ids], [x_initial, gamma_initial1, gamma_initial2, A_initial, C_initial], maxfev = 800000)
        
        X0s.append(popt[0])
        sigmes1.append(popt[1])
        sigmes2.append(popt[2])
        As.append(popt[3])
        Cs.append(popt[4])
        cov.append(pcov)
        f_x = asym_lorentz_C(x, popt[0], popt[1], popt[2], popt[3], popt[4])
        plt.plot(phases_arr[ids], f_arr[ids], '.')
        plt.plot(x, f_x)
        plt.savefig("Lor_fit_interval_"+str(i+1))
        plt.show()
        
    return X0s, sigmes1, sigmes2, As, Cs, cov
   
#Funci√≥ Lorentziana asimetrca per passarli el temps    
def funct_f(x,x0,sigma1,sigma2, A, C):
    
        x = x/T

        return 1./np.pi*np.where(x<=x0,A*sigma1/(sigma1**2+(x-x0)**2) + C,A*sigma2/(sigma2**2+(x-x0)**2)*sigma2*(1+sigma1*C)/sigma1)


"""
#Second graph
phase_1_2 = [0.10246909812644686, 0.12098761664496539, 0.13580243145978013, 0.1543209499782988, 0.1753086796513311, 0.19506169071903948, 0.2135802092375579, 0.23209872775607654, 0.25308645742910885, 0.27283946849681723, 0.29259259259259274, 0.30987650553385426, 0.3234568277994793, 0.3382716426142942, 0.34814814814814826, 0.36419756854022, 0.3691357647931136, 0.39259259259259277, 0.38148148148148153, 0.4037037037037038, 0.4061728018301506, 0.41234571668836817, 0.4197531240957756, 0.4246913203486691, 0.43703703703703717, 0.451851851851852, 0.46790127224392375, 0.48765428331163213, 0.503703703703704, 0.5246913203486689, 0.5419753463179977, 0.5654320610894098, 0.5839505796079283, 0.6037037037037039, 0.6209876166449653, 0.6382716426142939, 0.6580246536820022, 0.675308679651331]
f_1_2 = [0.032478528145032076, 0.02564102564102566, 0.02564102564102566, 0.02564102564102566, 0.032478528145032076, 0.029059776893028855, 0.0393161871494391, 0.0393161871494391, 0.06324775891426282, 0.0735041691706731, 0.08717948717948719, 0.1111110589443109, 0.14188028971354166, 0.1794871794871795, 0.22735032301682695, 0.27179487179487183, 0.3264956743289263, 0.4222221178886218, 0.37777772561097755, 0.38803413586738783, 0.33675208458533656, 0.28205128205128205, 0.2376067332732372, 0.19316234099559296, 0.13846153846153847, 0.09743589743589745, 0.0735041691706731, 0.04957259740584938, 0.032478528145032076, 0.0222221178886218, 0.011965707632211553, 0.008546956380208331, 0.008546956380208331, 0.005128205128205138, 0.008546956380208331, 0.008546956380208331, 0.008546956380208331, 0.005128205128205138]

phase_2_2 = [0.0901234944661459, 0.10987650553385428, 0.1320987277560765, 0.1481481481481483, 0.16913576479311362, 0.18395057960792843, 0.20123460557725695, 0.21851851851851867, 0.24197534631799786, 0.26419756854022003, 0.2864197907624423, 0.2987653944227432, 0.3197531240957755, 0.33456793891059033, 0.34814814814814826, 0.3592592592592593, 0.37283946849681715, 0.37777777777777793, 0.3938271981698497, 0.4012346055772571, 0.40493830928096075, 0.40987650553385424, 0.41728391294126166, 0.42222222222222233, 0.43703703703703717, 0.44938275372540526, 0.46913576479311336, 0.5135802092375579, 0.4888888888888891, 0.5407407407407407, 0.5617283573857061, 0.5851851851851853, 0.6654320610894098, 0.6074074074074076, 0.6320987277560766]
f_2_2 = [0.05299134865785257, 0.05299134865785257, 0.042734938401442324, 0.042734938401442324, 0.042734938401442324, 0.042734938401442324, 0.046153846153846156, 0.05641025641025643, 0.06666666666666668, 0.07692307692307693, 0.10085464868790066, 0.12820512820512822, 0.158974358974359, 0.2034187512520032, 0.2581195537860577, 0.316239264072516, 0.37435897435897436, 0.4222221178886218, 0.46324775891426284, 0.4222221178886218, 0.37094006660657053, 0.3128205128205128, 0.26495721279046475, 0.19658109224759618, 0.14871794871794874, 0.09743589743589745, 0.07008541791866987, 0.015384615384615385, 0.032478528145032076, 0.015384615384615385, 0.011965707632211553, 0.005128205128205138, 0.005128205128205138, 0.0017092973758013053, 0.005128205128205138]

phase_3_2 = [0.09753090187355332, 0.11481481481481493, 0.1320987277560765, 0.15555555555555572, 0.1753086796513311, 0.19876539442274307, 0.22098761664496533, 0.2469135425708913, 0.2691357647931135, 0.28395057960792836, 0.3061728018301506, 0.3197531240957755, 0.33456793891059033, 0.3432098388671877, 0.3555555555555557, 0.36543206108940973, 0.3716049759476274, 0.37901238335503484, 0.3901234944661459, 0.4000000000000002, 0.40493830928096075, 0.4074074074074075, 0.413580209237558, 0.42222222222222233, 0.42962962962962975, 0.4395061351634839, 0.45802465368200246, 0.4790123833550347, 0.5, 0.5185185185185186, 0.5395061351634838, 0.5604938648365163, 0.5790123833550348, 0.5950616907190395, 0.6135802092375577, 0.6320987277560766, 0.6580246536820022]
f_3_2 = [0.06324775891426282, 0.059829007662259626, 0.05299134865785257, 0.04957259740584938, 0.05641025641025643, 0.059829007662259626, 0.07008541791866987, 0.08376057942708334, 0.1111110589443109, 0.12820512820512822, 0.158974358974359, 0.2034187512520032, 0.2376067332732372, 0.28205128205128205, 0.32991442558092954, 0.37094006660657053, 0.4222221178886218, 0.47350416917067306, 0.5213674692007212, 0.47350416917067306, 0.4256410256410257, 0.37777772561097755, 0.3059828538161058, 0.2376067332732372, 0.1863246819911859, 0.13846153846153847, 0.08717948717948719, 0.05641025641025643, 0.0393161871494391, 0.0222221178886218, 0.018803366636618607, 0.011965707632211553, 0.008546956380208331, 0.008546956380208331, 0.005128205128205138, 0.0017092973758013053, 0.0017092973758013053]

phase_4_2 = [0.09259259259259267, 0.11358020923755799, 0.13827164261429412, 0.16049386483651626, 0.1827160870587385, 0.21111111111111125, 0.2333333333333335, 0.2543209499782987, 0.2777777777777779, 0.2950616907190394, 0.3123457166883681, 0.32839502405237286, 0.34197534631799775, 0.34197534631799775, 0.34197534631799775, 0.35185185185185186, 0.3629629629629631, 0.3691357647931136, 0.37777777777777793, 0.3938271981698497, 0.3827160870587385, 0.4000000000000002, 0.4037037037037038, 0.4061728018301506, 0.40987650553385424, 0.4148148148148149, 0.4209876166449654, 0.42839502405237284, 0.43703703703703717, 0.4543209499782985, 0.4716049759476273, 0.4913579870153356, 0.5135802092375579, 0.5382716426142939, 0.5567901611328125, 0.5753086796513311, 0.5950616907190395, 0.6160494203920719, 0.6358024314597801, 0.6530864574291088, 0.674074074074074]
f_4_2 = [0.07692307692307693, 0.06666666666666668, 0.06666666666666668, 0.06324775891426282, 0.07008541791866987, 0.07692307692307693, 0.08717948717948719, 0.11794871794871796, 0.14529904096554488, 0.1794871794871795, 0.21709391276041667, 0.2581195537860577, 0.3059828538161058, 0.3059828538161058, 0.3059828538161058, 0.35384615384615387, 0.4017092973758013, 0.4495725974058494, 0.4940169896834936, 0.5726495204827724, 0.5452990409655449, 0.5316238794571314, 0.47350416917067306, 0.4153846153846154, 0.36752131535456734, 0.2991451948116987, 0.24444439227764425, 0.19316234099559296, 0.14529904096554488, 0.10085464868790066, 0.05299134865785257, 0.0393161871494391, 0.02564102564102566, 0.015384615384615385, 0.008546956380208331, 0.008546956380208331, 0.008546956380208331, 0.008546956380208331, 0.008546956380208331, 0.005128205128205138, 0.005128205128205138]

phase_5_2 = [0.09259259259259267, 0.11851851851851863, 0.14567905002170142, 0.17037037037037056, 0.19382719816984975, 0.2135802092375579, 0.23827164261429404, 0.2567901611328126, 0.2777777777777779, 0.29753090187355336, 0.3123457166883681, 0.3234568277994793, 0.33456793891059033, 0.34938275372540517, 0.3617283573857062, 0.3691357647931136, 0.37283946849681715, 0.38148148148148153, 0.3938271981698497, 0.4012346055772571, 0.4024690981264468, 0.4061728018301506, 0.4111111111111112, 0.4148148148148149, 0.4086420129846645, 0.4197531240957756, 0.4246913203486691, 0.43333333333333346, 0.4456790500217015, 0.46049386483651633, 0.47777777777777775, 0.4975309018735534, 0.5382716426142939, 0.5567901611328125, 0.5790123833550348, 0.5987653944227431, 0.6185185185185187, 0.6419753463179978, 0.6691357647931134, 0.5197531240957755]
f_5_2 = [0.09743589743589745, 0.0905982384314904, 0.08717948717948719, 0.0940169896834936, 0.10427339993990385, 0.1076923076923077, 0.12478622045272438, 0.15555545122195513, 0.1794871794871795, 0.22051282051282053, 0.24444439227764425, 0.2991451948116987, 0.33675208458533656, 0.391452887119391, 0.45299134865785257, 0.5111110589443109, 0.5623931102263622, 0.6170939127604167, 0.6547008025340545, 0.6034187512520033, 0.5487179487179488, 0.4940169896834936, 0.391452887119391, 0.34017083583733976, 0.4393161871494391, 0.2786323742988782, 0.22051282051282053, 0.16923076923076924, 0.12136746920072117, 0.07692307692307693, 0.05641025641025643, 0.03589743589743591, 0.015384615384615385, 0.008546956380208331, 0.005128205128205138, 0.0017092973758013053, -0.00512820512820511, 0.0017092973758013053, 0.0017092973758013053, 0.018803366636618607]

phase_6_2 = [0.08518518518518525, 0.1074074074074075, 0.12962962962962976, 0.1518518518518519, 0.17407407407407416, 0.19753090187355335, 0.21604942039207178, 0.23456793891059044, 0.25308645742910885, 0.2740740740740742, 0.29012349446614594, 0.30370370370370375, 0.3197531240957755, 0.3320987277560765, 0.3432098388671877, 0.35432094997829877, 0.36049386483651624, 0.36790127224392366, 0.3753086796513311, 0.38024687590422457, 0.39135798701533586, 0.4000000000000002, 0.4037037037037038, 0.4061728018301506, 0.4074074074074075, 0.40987650553385424, 0.413580209237558, 0.4197531240957756, 0.4246913203486691, 0.4345679389105904, 0.44691354257089133, 0.4592592592592594, 0.5049383092809608, 0.5234568277994791, 0.5469135425708913, 0.5654320610894098, 0.590123494466146, 0.6320987277560766, 0.6506172462745949, 0.6111111111111113, 0.47407407407407426, 0.4925925925925926]
f_6_2 = [0.12820512820512822, 0.12136746920072117, 0.1111110589443109, 0.11452981019631411, 0.11794871794871796, 0.13162387945713142, 0.14871794871794874, 0.16923076923076924, 0.19316234099559296, 0.22393157176482373, 0.2581195537860577, 0.2923076923076923, 0.3435897435897436, 0.38461538461538464, 0.43247852814503207, 0.48376057942708334, 0.5487179487179488, 0.5965810922475961, 0.6478631435296475, 0.7094016050681089, 0.7709400666065704, 0.7162392640725161, 0.6512820512820513, 0.5863246819911859, 0.5111110589443109, 0.4495725974058494, 0.37435897435897436, 0.316239264072516, 0.24102564102564103, 0.1829059307391827, 0.12820512820512822, 0.0735041691706731, 0.032478528145032076, 0.02564102564102566, 0.015384615384615385, 0.015384615384615385, 0.011965707632211553, 0.008546956380208331, 0.008546956380208331, 0.005128205128205138, 0.05299134865785257, 0.042734938401442324]

phase_7_2 = [0.08641979076244219, 0.10493830928096073, 0.127160531503183, 0.14938275372540524, 0.17037037037037056, 0.19135798701533566, 0.21111111111111125, 0.23086423520688662, 0.2469135425708913, 0.2654320610894098, 0.2654320610894098, 0.2777777777777779, 0.29259259259259274, 0.30987650553385426, 0.3222222222222224, 0.3358024314597803, 0.34567905002170163, 0.35432094997829877, 0.3629629629629631, 0.3703703703703705, 0.376543172200521, 0.3827160870587385, 0.3901234944661459, 0.38395057960792844, 0.39753090187355333, 0.4012346055772571, 0.4037037037037038, 0.4037037037037038, 0.4061728018301506, 0.4086420129846645, 0.4086420129846645, 0.40493830928096075, 0.4111111111111112, 0.413580209237558, 0.4160494203920718, 0.4197531240957756, 0.42345682779947924, 0.4320987277560765, 0.4395061351634839, 0.451851851851852, 0.4716049759476273, 0.4913579870153356, 0.587654283311632, 0.5074074074074074, 0.5296296296296297, 0.550617246274595, 0.5666666666666668, 0.6061728018301507, 0.6234568277994792, 0.639506135163484, 0.6604938648365162, 0.6802468759042246]
f_7_2 = [0.17264952048277243, 0.15555545122195513, 0.14871794871794874, 0.15213669996995194, 0.158974358974359, 0.16923076923076924, 0.1863246819911859, 0.20683750250400643, 0.22735032301682695, 0.2581195537860577, 0.2581195537860577, 0.2923076923076923, 0.32991442558092954, 0.37777772561097755, 0.4222221178886218, 0.47350416917067306, 0.5282051282051282, 0.5863246819911859, 0.6478631435296475, 0.7025641025641025, 0.75042724609375, 0.8017092973758013, 0.8700854179186699, 0.8427349384014424, 0.8358974358974358, 0.7914528871193911, 0.7401708358373398, 0.6923076923076923, 0.6205128205128205, 0.5692307692307692, 0.5282051282051282, 0.6547008025340545, 0.48717948717948717, 0.4290597768930289, 0.36410256410256414, 0.3059828538161058, 0.2581195537860577, 0.20683750250400643, 0.1623931102263622, 0.10427339993990385, 0.06324775891426282, 0.042734938401442324, 0.015384615384615385, 0.032478528145032076, 0.018803366636618607, 0.018803366636618607, 0.011965707632211553, 0.011965707632211553, 0.011965707632211553, 0.011965707632211553, 0.011965707632211553, 0.008546956380208331]

phase_8_2 = [0.09135798701533573, 0.10987650553385428, 0.1308642352068867, 0.15061724627459497, 0.1716049759476275, 0.19382719816984975, 0.21728391294126173, 0.2370370370370371, 0.2543209499782987, 0.27160497594762745, 0.29012349446614594, 0.30493830928096066, 0.3197531240957755, 0.32839502405237286, 0.33950613516348394, 0.34814814814814826, 0.3555555555555557, 0.36543206108940973, 0.37283946849681715, 0.37901238335503484, 0.3827160870587385, 0.3938271981698497, 0.39876539442274317, 0.4012346055772571, 0.4012346055772571, 0.40493830928096075, 0.4086420129846645, 0.40987650553385424, 0.4086420129846645, 0.4111111111111112, 0.413580209237558, 0.4160494203920718, 0.4185185185185186, 0.42222222222222233, 0.42592592592592604, 0.4345679389105904, 0.4395061351634839, 0.44691354257089133, 0.45802465368200246, 0.4728394684968173, 0.49506169071903955, 0.5185185185185186, 0.5395061351634838, 0.5617283573857061, 0.5814814814814816, 0.6000000000000001, 0.6197531240957757, 0.6432098388671874, 0.661728357385706, 0.6851851851851852]
f_8_2 = [0.21025641025641026, 0.18974358974358976, 0.19316234099559296, 0.19316234099559296, 0.19658109224759618, 0.21367516150841348, 0.2376067332732372, 0.26837596404246794, 0.2991451948116987, 0.33675208458533656, 0.38119647686298075, 0.4188033666366186, 0.4666666666666667, 0.5247862204527244, 0.5692307692307692, 0.6341879820212339, 0.7025641025641025, 0.7675213153545672, 0.8222221178886218, 0.8974358974358974, 0.9555555294721554, 1.017093991010617, 0.9726495204827725, 0.9145298884465145, 0.8666666666666667, 0.8051282051282052, 0.7299144255809296, 0.6717948717948719, 0.6102564102564103, 0.5452990409655449, 0.49743589743589745, 0.4427349384014423, 0.38461538461538464, 0.3230769230769231, 0.26495721279046475, 0.21367516150841348, 0.1623931102263622, 0.11794871794871796, 0.08034182817508013, 0.05641025641025643, 0.032478528145032076, 0.018803366636618607, 0.011965707632211553, 0.011965707632211553, 0.011965707632211553, 0.011965707632211553, 0.005128205128205138, 0.0017092973758013053, 0.0017092973758013053, -0.0017094538762019162]

phases = [phase_1_2, phase_2_2, phase_3_2, phase_4_2, phase_5_2, phase_6_2, phase_7_2, phase_8_2]
fs =  [f_1_2, f_2_2, f_3_2, f_4_2, f_5_2, f_6_2, f_7_2, f_8_2]
"""